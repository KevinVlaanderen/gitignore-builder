#!/usr/bin/env ruby

$: << File.expand_path(File.dirname(__FILE__) + "/../lib")

require 'optparse'
require 'methadone'
require 'gitignores'
require 'gitignores/version'
require 'gitignores/exceptions'

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do |*ignores|
    opts = {
      :ignores_dir => options['use-directory'],
      :update => false
    }
    # begin
      Gitignores.main(ignores, opts)
    # rescue RuntimeError => e
    #   puts e.ignore_name
    # end
  end

  description Gitignores::DESCRIPTION
  
  options['use-directory'] = ENV['HOME'] + '/.gitignores'
  on("-d ignore-repository", "--use-directory", "The directory in which to store the github/gitignore directory")
  on("--update", "Update the github/gitignore repository")

  arg :ignores, :many

  version Gitignores::VERSION

  use_log_level_option

  go!
end
